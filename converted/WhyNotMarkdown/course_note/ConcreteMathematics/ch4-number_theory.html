<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ch4-number_theory</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   var macros = [];
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      macros: macros,
      fleqn: false
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="初等数论内容概述">初等数论内容概述</h1>
<p>引入一些群论的想法有助于学习初等数论.</p>
<ul>
<li><p>带余除法,整除,同余,整系数线性不定方程 几种基础表达形式的互相转化.</p></li>
<li><p>素数,互质,最大公约数, Beazout’s theorem, Eculidean’s algorithm.</p></li>
<li><p>算数基本定理.</p></li>
<li><p>数论函数, 数论函数求和问题.</p></li>
<li><p>线性同余方程组,CRT</p></li>
<li><p>模意义下的指数函数, 欧拉定理, 原根, 离散对数问题.</p></li>
<li><p>模意义下的幂函数, 二次剩余.</p></li>
<li><p>MISC</p>
<ul>
<li><p>费马大定理(Fermat’s last theorem)</p></li>
<li><p>Wilson’s theorem, <span class="math inline">p\text{ is a prime} \iff (p-1)!\equiv 1\pmod p</span></p></li>
<li><p>素性判定和整数分解算法.</p></li>
<li><p>素数分布, 素数定理.</p></li>
<li><p>初等数论的密码学应用.</p></li>
<li><p>狄利克雷生成函数 Dirichlet generating function.</p></li>
<li><p>连分数.</p></li>
</ul></li>
</ul>
<h1 id="eulers-totient-function-and-eulers-theorem">Euler’s totient function and Euler’s theorem</h1>
<p>Let <span class="math inline">\mathbb{Z}_n=\{[k]\mid k\in \mathbb{Z}\}</span> where <span class="math inline">[k]=\{ x\mid x\equiv k\pmod n \}</span>. Consider <span class="math inline">\mathbb{Z}_n^\ast = \{[k]\in \mathbb{Z}_n \mid k\perp n\}</span>, define <span class="math inline">\varphi(n)=\left\vert|Z_n^\ast|\right\vert</span>.<br />
The Euler’s theorem claims that <span class="math inline">(a,n)=1\implies a^{\varphi(n)}\equiv 1\pmod n</span></p>
<h2 id="evaluating-eulers-totient-function">Evaluating Euler’s totient function</h2>
<p>Let <span class="math inline">U=\{p_1,p_2\ldots p_m\}</span> be the set of prime factors of <span class="math inline">n</span><br />
For every <span class="math inline">S\in \rho(U)</span>, define</p>
<ul>
<li><p><span class="math inline">f(S)=\left\vert
              \left\{
              k\in \mathbb{Z}_n
              \mid
              (p\in S \leftrightarrow p\mid k)
              \right\}
              \right\vert</span></p></li>
<li><p><span class="math inline">g(S)=\left\vert
              \left\{
              k\in \mathbb{Z}_n
              \mid
              (p\in S \rightarrow p\mid k)
              \right\}
              \right\vert=n\prod_{p\in S} \frac{1}{p}</span></p></li>
</ul>
<p>We have <span class="math inline">g(S)=\sum_{S\subseteq T\subseteq U} f(T)</span>. Applying the Mobius’s inversion to get <span class="math inline">f(S)=\sum_{S\subseteq T\subseteq U}{(-1)}^{|T|-|S|}g(T)</span>.<br />
<span class="math display">\begin{aligned}
        \varphi(n)
         &amp; =f(\varnothing)                                                                                        \\
         &amp; =n\sum_{S\subseteq \{p_1,p_2\ldots p_m\}}{(-1)}^{|S|}\prod_{p \in S}\frac{1}{p}                        \\
         &amp; =n\sum_{S\subseteq \{p_1,p_2\ldots p_m\}}\left(\prod_{p \in S}\frac{-1}{p} \prod_{j\not\in S} 1\right) \\
         &amp; =n\prod_{p\in S}(1-\frac{1}{p})
    \end{aligned}</span></p>
<h2 id="the-eulers-theorem">The Euler’s theorem</h2>
<p><span class="math inline">(\mathbb{Z}_n^\ast,\times)</span> is a commutative group. Consider <span class="math inline">a\mathbb{Z}_n^\ast=\{[ak]\mid [k]\in \mathbb{Z}_n^\ast\}</span> We claim that <span class="math inline">a\mathbb{Z}_n^\ast = \mathbb{Z}_n^\ast</span>, otherwise<br />
<span class="math display">\begin{aligned}
         &amp; \exists x,y\quad x,y\perp n\land x\not\equiv y\pmod n                            \\
         &amp; ax\equiv ay\pmod n                                                               \\
         &amp; (a,n)=1\implies \exists a^{-1}\text{ s.t. } a^{-1}a\equiv aa^{-1}\equiv 1\pmod n \\
         &amp; a^{-1}ax\equiv x\equiv a^{-1}ay\equiv y\pmod n
    \end{aligned}</span></p>
<p>Therefore</p>
<p><span class="math display">\begin{aligned}
        \prod_{k\perp n} k                &amp; \equiv \prod_{k\perp n} ak &amp; \pmod n \\
        a^{\varphi(n)} \prod_{k\perp n} k &amp; \equiv \prod_{k\perp n} k  &amp; \pmod n \\
        a^{\varphi(n)}                    &amp; \equiv 1                   &amp; \pmod n
    \end{aligned}</span></p>
<p>For the second step: <span class="math inline">\mathbb{Z}_n^\ast</span> is closed under multiplication, so <span class="math inline">\prod_{k\perp n} k</span> is also in <span class="math inline">\mathbb{Z}_n^\ast</span>, which means it is invertible.</p>
<h1 id="primitive-root-modulo-a-prime">primitive root (modulo a prime)</h1>
<h2 id="definition">definition</h2>
<ul>
<li><p><strong>multiplicative order</strong>: <span class="math inline">\forall x\in \mathbb{Z}_p^\ast\ \mathrm{ord}_p(x)=\min\{k\in \mathbb{Z}^+\mid x^k\equiv 1\pmod p\}</span><br />
key property: <span class="math inline">\mathrm{ord}_p(x) \mid \varphi(p)=p-1</span>, otherwise: <span class="math display">1
                    \equiv x^{\varphi(p)}
                    \equiv x^{p-1}
                    \equiv x^{\left\lfloor{\frac{p-1}{\mathrm{ord}(x)}\mathrm{ord}(x)}\right\rfloor+(p-1)\bmod \mathrm{ord}(x)}
                    \equiv x^{(p-1)\bmod \mathrm{ord}(x)}
                    \not\equiv 1
                    \pmod p</span></p></li>
<li><p><strong>index</strong>: <span class="math inline">\forall x\in \mathbb{Z}_p^\ast,g\in \mathbb{Z}_p^\ast\ \mathrm{idx}_g(x)=\min\{k\in \mathbb{N}\mid g^k\equiv x\pmod p\}</span></p></li>
<li><p><strong>primitive root</strong>: The generators of the multiplicative group <span class="math inline">\mathbb{Z}_p^\ast</span> are called the primitive roots modulo <span class="math inline">p</span>.<br />
For a prime number <span class="math inline">p</span>, we say that <span class="math inline">g</span> is the primitive root modulo <span class="math inline">p</span> if <span class="math inline">\mathbb{Z}_p^\ast = \{[1],[2]\ldots [p-1]\}=\{[g^0],[g^1]\ldots [g^{\varphi(p)-1}]=[g^{p-2}]\}</span>.<br />
<span class="math inline">g</span> is a primitive root modulo <span class="math inline">p</span> iff <span class="math inline">\mathrm{ord}_p(g)=\varphi(p)=p-1</span></p></li>
</ul>
<h2 id="existance-of-primitive-root">existance of primitive root</h2>
<p><strong>theorem:</strong> For every odd prime number <span class="math inline">p</span>, the primitive root modulo <span class="math inline">p</span> exists.<br />
Therefore, for any odd prime number number <span class="math inline">p</span>, the multiplicative group <span class="math inline">\mathbb{Z}_p^\ast</span> is a cyclic group.</p>
<h2 id="properties-of-primitive-root">properties of primitive root</h2>
<h3 id="count-of-distinct-primitive-roots-modulo-a-prime">count of distinct primitive roots modulo a prime</h3>
<p>Let <span class="math inline">g</span> be a primitive root modulo <span class="math inline">p</span>. Then <span class="math inline">\forall x\in \mathbb{Z}_p^\ast\ \exists!k\in\{0,1,2\ldots p-2\}\ g^p\equiv x\pmod p</span><br />
For <span class="math inline">o=\mathrm{ord}_p(x)=\mathrm{ord}_p(g^k)</span>, we have <span class="math inline">x^o\equiv g^{ko}\equiv g^{0}\equiv 1\pmod p</span><br />
Let <span class="math inline">ko=q(p-1)+r</span> where <span class="math inline">q\in \mathbb{Z}</span> and <span class="math inline">0\leq r&lt;p-1</span>, so <span class="math inline">g^{ko}\equiv g^{q(p-1)}\cdot g^{r}\equiv g^r\equiv 1\pmod p</span>.<br />
Since the multiplicative order of <span class="math inline">g</span> is <span class="math inline">p-1</span>, we must have <span class="math inline">r=0</span>, which implies <span class="math inline">(p-1)\mid ko\iff ko\equiv 0\pmod{p-1}</span>.<br />
When <span class="math inline">k\perp (p-1)</span>, the multiplicative order of <span class="math inline">x</span> will be <span class="math inline">p-1</span>, which means <span class="math inline">x\equiv g^k</span> is a primitive root modulo <span class="math inline">p</span>. Moreover, only when <span class="math inline">(k,p-1)=1</span>, the smallest positive integer solution <span class="math inline">o</span> of i.e. <span class="math inline">\mathrm{ord}_p(x)</span> <span class="math inline">ko\equiv 0\pmod {p-1}</span> is <span class="math inline">p-1</span><br />
Therefore, there are <span class="math inline">\sum_{i=1}^{p-1}[\gcd(i,p-1)=1]=\varphi(p-1)</span> distinct primitive roots modulo <span class="math inline">p</span>.</p>
<h3 id="roots-of-unity">roots of unity</h3>
<p>solve the equation of <span class="math inline">x</span>, <span class="math inline">x^m \equiv 1\pmod p</span>. Suppose that <span class="math inline">x=g^k\ (0\leq k&lt;p-1)</span> is the solution, then <span class="math inline">g^{km}\equiv 1\pmod p</span>.<br />
Let <span class="math inline">q=\left\lfloor{\frac{km}{p-1}}\right\rfloor</span> and <span class="math inline">r=km\bmod {p-1}</span>, <span class="math inline">g^{km}\equiv g^{(p-1)k}\cdot g^r\equiv g^r\equiv 1\pmod p</span>.<br />
Therefore <span class="math inline">r=0</span> and <span class="math inline">(p-1)\mid km\iff \frac{p-1}{\gcd(m,p-1)}\mid k</span>.</p>
<p>So, there are <span class="math inline">(p-1,m)</span> distinct <span class="math inline">m</span>-th roots of unity in <span class="math inline">\mathbb{Z}_p</span>.</p>
<h3 id="quadratic-residule">quadratic residule</h3>
<p><strong>definition</strong>: <span class="math inline">a</span> is a quadratic residule modulo <span class="math inline">p</span> iff <span class="math inline">\exists x\ x^2\equiv a\pmod p</span>.<br />
Let <span class="math inline">k=\mathrm{idx}_g(a)</span>, where <span class="math inline">g</span> is a primitive root.</p>
<ul>
<li><p><span class="math inline">2\mid k</span>. <span class="math inline">x\equiv g^{k/2}\pmod p</span> is the square root of <span class="math inline">a</span>.<br />
<span class="math inline">a</span> is a quadratic residule.</p></li>
<li><p><span class="math inline">2\nmid k</span>. Suppose that <span class="math inline">x\equiv g^r\pmod p</span> is the square of <span class="math inline">a</span> modulo <span class="math inline">p</span><br />
<span class="math inline">a\equiv x^2\equiv g^{2r}\equiv g^{k}\pmod p\iff g^{2r-k}\equiv 1\pmod p</span>.<br />
Let <span class="math inline">q=\left\lfloor{\frac{2r-k}{p-1}}\right\rfloor,r=(2r-k)\bmod {(p-1)}</span>, we can show that <span class="math inline">r=0</span> and <span class="math inline">(p-1)\mid (2r-k)</span>.<br />
However, <span class="math inline">p-1</span> is a even number while <span class="math inline">2r-k</span> is a odd number, this is impossible.<br />
Thus, <span class="math inline">a</span> is not a quadratic nonresidue.</p></li>
</ul>
<p>Similarly we can show that <span class="math inline">2\mid k</span> if <span class="math inline">a</span> is a quadratic residule. In conclusion, <span class="math inline">a\text{ is a quadratic residule} \iff 2\mid \mathrm{idx}_g(a)</span><br />
This tells us that among <span class="math inline">\mathbb{Z}_p^\ast=\{[g^0],[g^1]\ldots [g^{p-2}]\}</span> there are <span class="math inline">\frac{p-1}{2}</span> quadratic residule. The property will be used when developing Cipolla’s algorithm<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p><strong>Euler’s criterion</strong>: <span class="math inline">a^{\frac{p-1}{2}}\bmod p=\begin{cases}1 &amp; a \text{ is a quadratic residule}\\ -1&amp; a\text{ is a quadratic nonresidue}\\ 0 &amp; p\mid a\end{cases}</span></p>
<p>Let <span class="math inline">k=\mathrm{idx}_g(a)</span>, where <span class="math inline">g</span> is a primitive root.</p>
<ul>
<li><p><span class="math inline">a\text{ is a quadratic residule}\implies 2\mid k</span><br />
Let <span class="math inline">i=\frac{k}{2}</span>, <span class="math inline">a^{\frac{p-1}{2}}\equiv g^{(p-1)i}\equiv 1\pmod p</span></p></li>
<li><p><span class="math inline">a\text{ is a quadratic nonresidule}\implies 2\nmid k</span><br />
Let <span class="math inline">k=2i+1</span>, <span class="math inline">a^{\frac{p-1}{2}}\equiv g^{(p-1)i}\cdot g^{\frac{p-1}{2}}\equiv g^{\frac{p-1}{2}}\pmod p</span><br />
Let <span class="math inline">x\equiv g^{\frac{p-1}{2}}</span>, then <span class="math inline">x^2\equiv 1\pmod p\iff (x+1)(x-1)\pmod p</span><br />
<span class="math inline">p</span> has no factor besides itself, so <span class="math inline">\left(p\mid (x+1)\right)\lor \left(p\mid (x-1)\right)</span><br />
Since <span class="math inline">g</span> is a primitive root, <span class="math inline">\mathrm{ord}_p(g)=p-1</span> so <span class="math inline">x\equiv g^{\frac{p-1}{2}}\equiv 1\pmod p</span> can not be the case.<br />
Hence, <span class="math inline">x\equiv g^{\frac{p-1}{2}}\equiv -1</span></p></li>
</ul>
<p>The other direction.</p>
<ul>
<li><p>Suppose that <span class="math inline">a^{\frac{p-1}{2}}\equiv g^{k\frac{p-1}{2}}\equiv 1\pmod p</span><br />
Then, <span class="math inline">p-1\mid k\frac{p-1}{2}\implies \left(2{(p-1)}^2\right)\mid k\implies 2\mid k</span><br />
So <span class="math inline">a</span> is a quadratic residule.</p></li>
<li><p>Suppose that <span class="math inline">a^{\frac{p-1}{2}}\equiv g^{k\frac{p-1}{2}}\equiv -1\equiv g^{\frac{p-1}{2}}\pmod p</span><br />
Then <span class="math inline">g^{k\frac{p-1}{2}}{\left(g^{-1}\right)}^{\frac{p-1}{2}}\equiv g^{(k-1)\frac{p-1}{2}}\equiv 1</span>,<br />
which implies <span class="math inline">2\mid (k-1)\implies 2\nmid k</span><br />
So <span class="math inline">a</span> is a quadratic nonresidule.</p></li>
</ul>
<p>In conclusion.</p>
<ul>
<li><p><span class="math inline">a^{\frac{p-1}{2}}\equiv 1\pmod p</span> iff <span class="math inline">a</span> is a quadratic residule.</p></li>
<li><p><span class="math inline">a^{\frac{p-1}{2}}\equiv -1\pmod p</span> iff <span class="math inline">a</span> is a quadratic nonresidule.</p></li>
</ul>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>An efficient algorithm for solving modular quadratic equation<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
